steps:
  - name: 'node:18.13'
    args:
      - install
    entrypoint: npm
  - name: 'node:18.13'
    args:
      - run
      - build
    entrypoint: npm
  - name: gcr.io/google.com/cloudsdktool/cloud-sdk
    args:
      - gcloud
      - storage
      - rm
      - '-r'
      - 'gs://${_FRONTEND_BUCKET_NAME}/**'
  - name: 'node:18.13'
    args:
      - '-c'
      - |
        REACT_APP_BACKEND_ADDRESS=${_BACKEND_ADDRESS} npm run build
    entrypoint: bash
  - name: gcr.io/google.com/cloudsdktool/cloud-sdk
    args:
      - gcloud
      - storage
      - cp
      - '-r'
      - /workspace/build/*
      - 'gs://${_FRONTEND_BUCKET_NAME}'
